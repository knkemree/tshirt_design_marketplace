

{% block javascript %}
<script>
$(document).ready(function() { 

    function get_current_variant(){
      $.ajax({
        url: "{% url 'essentials:get_current_variant' %}",
        data: {
          'product_id': $('#productid').val(),
          'size_id': $('#size-selector').val(),
          'color_id': $('input[name=colorid]:checked', '#post-color').val(),
        },
        dataType: 'json',
        success: function(data){
            var variant_id = data.variant_id
            console.log(data.variant_id)
        },

      })
    };

    function ajax_change_size(){
      $.ajax({
        url:'{% url "essentials:change_size" %}',
        data:{
            product_id:$('#productid').val(),
            size:$('#size-selector').val(),
            'method_id': $( "#technique" ).val(),
            'place_id': $('.cz-thumblist-item.active').attr('id'),
            'color_id': $('input[name=colorid]:checked', '#post-color').val(),
            csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]', '#post-size').val(),
        },
        success: function (data) {
            $('#appendHere').html(data.rendered_table);
            $('#price').text("$"+data.price_all_included);
        },
        error: function (data) {
            alert("Got an error! " + data);
        }
      });
      get_current_variant();
    };


    $('input[name=colorid]', '#post-color').change(function(e){
        $('#post-color').submit();

        // dogru variant'i checked olarak gostrebilmek icin change_size calistirmak gerekiyor
        ajax_change_size();
        
    });
});
</script>
{% endblock %}



{% for rs in colors %}

    <div class="custom-control custom-option custom-control-inline mb-2">
        <input type="radio" style="display: none;" name="hexOrTexture" value="{% if rs.color.texture %}{{ rs.color.texture.url }}{% else %}{{ rs.color.color_code }}{% endif %}" {% if variant.id == rs.id %} checked {% endif %}>
        <input type="hidden" name="variantid" value="{{ rs.id }}" {% if variant.id == rs.id %} checked {% endif %}>
        <input class="custom-control-input" data-label="colorOption" type="radio" name="colorid" id="{{ rs.color.id }}" value="{{ rs.color.id }}" {% if variant.id == rs.id %} checked {% endif %}>
        <label data-toggle="tooltip" data-placement="bottom" title="{{ rs.color.name }}" class="custom-option-label rounded-circle" for="{{ rs.color.id }}"><span class="custom-option-color rounded-circle" style="{% if rs.color.texture %}background-image: url({{ rs.color.texture.url }}){% else %}background-color: {{ rs.color.color_code }}{% endif %}"></span></label>
    </div>
    <!-- {% if ajax_variant.id == rs.id %}
    <script>
        $(document).ready(function(e) { 
            e.preventDefault();
            $( "#post-color" ).submit();
        })
        
    </script>
    {% endif %} -->
{% endfor %}


